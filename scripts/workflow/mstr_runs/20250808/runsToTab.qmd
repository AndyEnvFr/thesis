---
title: "runs to tbl"
author: "ai"
format: html
editor: visual
---

# load

```{r}
#| warning: false
library(PhyloSim)
library(parallel)
library(dplyr)
# root <- "~/Uni/Master/MA/" # work from local machine
root <- "~/cyber_synch/" # work from uni bayreuth server
# source(paste0(root, "/git_synch/scripts/functions.R"))
```

```{r}
runs <- readRDS(paste0(root, "local/runs/mstr/20250808/runs_i.rds"))
```

```{r}
runs <- getConNeigh(runs = runs)
```

# transform matrix in df - parallel

#Ã¤ works for windows too
```{r}
cl <- makeCluster(length(runs))
clusterExport(cl, c("getMatToTab", "runs"))
tab <- parLapply(cl = cl, X = runs, fun = function(x) getMatToTab(x, detailedParams = TRUE))
saveRDS(tab, paste0(root, "local/runs/mstr/20250722/runsTab.rds"))
```

## faster version for bash / mac
```{r}
tab <- mclapply(runs, getMatToTab, detailedParams = TRUE, mc.cores = 46)
saveRDS(tab, file.path(root, "local/runs/mstr/20250808/tab.rds"))
```

